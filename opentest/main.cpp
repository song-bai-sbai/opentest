#include <iostream>
#include <opencv2/opencv.hpp>
#include <tchar.h>
#include <core/core_c.h>
#include "main.h"

using namespace std;
using namespace cv;


int _tmain(int argc, _TCHAR* argv[])
{
	 char* imagename = "lena.jpg";

	IplImage* img=cvLoadImage(imagename,-1);

	IplImage* img_2=cvCreateImage(cvGetSize(img),IPL_DEPTH_8U,3);

	IplImage* img_wm = cvLoadImage("th1.jpg",-1);

	if(img==NULL)
	{
		fprintf(stderr, "Can not load image %s\n", imagename);
		return -1;
	}
	/* -------------------------------  Test Operation  ---------------------------------------*/
	
	//test_smooth(img,img_2);

	//test_adjust_bright(img,img_2);
	
	//test_adjust_contrast(img,img_2);

	//test_usmsharp(img,img_2);
	
	//test_putWm_img(img,img_wm);
	  IplImage *imgForTest;
	 //imgForTest=test_resize(img);
	  imgForTest =test_clippig(img,0,0,100,100);
	/* -------------------------------  Test Operation  ---------------------------------------*/
	cvNamedWindow("prototype");
	cvNamedWindow("test");
	cvShowImage("prototype",img);
	cvShowImage("test",imgForTest);
	//此函数等待按键，按键盘任意键就返回
	waitKey();
	cvReleaseImage(&img); 
	cvDestroyWindow("prototype");
	cvReleaseImage(&img_2); 
	cvDestroyWindow("test");
	return 0;
}

void test_smooth(IplImage *src, IplImage* dst)
{
	MySmooth ms;
	ms.doSmooth(src,dst,1);

}

void test_adjust_bright(IplImage *src, IplImage* dst)
{
	MyBri_Con mb;
	mb.adjust_bright(src,dst,200);
}

void test_adjust_contrast(IplImage *src, IplImage* dst)
{
	MyBri_Con mb;
	mb.adjust_contrast(src,dst,0.03);
	//mb.old_AdjustContrast(src,dst,60);
}

void test_usmsharp(IplImage *src, IplImage *dst)
{
	MySharp ms ;
	ms.usmSharp(src,dst,40,3,2);
}

void test_putWm_img(IplImage *img, IplImage *wm)
{
	Mat imgMat(img,0); 
	Mat imgWm(wm,0);
	MyLogo_WM mlw;
	mlw.putWM_img(imgMat,imgWm,0,0);
}

IplImage* test_resize(IplImage *src)
{
	MyResize mr;
	return mr.resize_CV_INTER_LINEAR(src,0.5);
	//return mr.resize_CV_INTER_AREA(src,0.3);
	//return mr.resize_CV_INTER_NN(src,1.5);
	//return mr.resize_CV_INTER_CUBIC(src,1.5);

}

IplImage * test_clippig( IplImage * src,int start_x, int start_y,int end_x, int end_y )
{
	MyClipping mc;
	return mc.clip(src,start_x,start_y,end_x,end_y);
}
